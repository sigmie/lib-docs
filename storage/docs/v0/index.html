<ul class="table-of-contents">
<li>
<a href="#content-introduction">Introduction</a>
<ul>
<li>
<a href="#content-what-is-an-index">What is an Index?</a>
</li>
<li>
<a href="#content-what-is-a-document">What is a Document?</a>
</li>
</ul>
</li>
<li>
<a href="#content-first-index">First Index</a>
<ul>
<li>
<a href="#content-create-an-index">Create an Index</a>
</li>
<li>
<a href="#content-add-documents">Add Documents</a>
</li>
</ul>
</li>
<li>
<a href="#content-analysis">Analysis</a>
<ul>
<li>
<a href="#content-what-is-analysis">What is Analysis?</a>
</li>
<li>
<a href="#content-how-are-documents-analyzed">How are Documents analyzed?</a>
</li>
<li>
<a href="#content-how-is-the-query-string-analyzed">How is the Query string analyzed?</a>
</li>
<li>
<a href="#content-how-to-test-analysis">How to test Analysis?</a>
</li>
<li>
<a href="#content-index-update">Index Update</a>
</li>
</ul>
</li>
<li>
<a href="#content-delete-an-index">Delete an Index</a>
</li>
<li>
<a href="#content-settings">Settings</a>
</li>
<li>
<a href="#content-how-update-works">How update works</a>
<ul>
<li>
<a href="#content-phase-1---create-new-index">Phase 1 - Create new index</a>
</li>
<li>
<a href="#content-phase-2---reindex-documents">Phase 2 - Reindex documents</a>
</li>
<li>
<a href="#content-phase-3---swap-alias">Phase 3 - Swap Alias</a>
</li>
<li>
<a href="#content-phase-4---delete-old-index">Phase 4 - Delete old index</a>
</li>
</ul>
</li>
<li>
<a href="#content-shards">Shards</a>
<ul>
<li>
<a href="#content-defining-shards">Defining shards</a>
</li>
<li>
<a href="#content-what-is-a-shard">What is a shard?</a>
</li>
<li>
<a href="#content-thumb-rules">Thumb rules</a>
</li>
<li>
<a href="#content-shards-behavior">Shards behavior</a>
<ul>
<li>
<a href="#content-what-happens-if-a-node-dies">What happens if a node dies?</a>
</li>
<li>
<a href="#content-what-happens-if-two-nodes-die">What happens if two nodes die?</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2><a id="content-introduction" href="#content-introduction" class="heading-permalink" aria-hidden="true" title="Permalink">#</a>Introduction</h2>
<h3><a id="content-what-is-an-index" href="#content-what-is-an-index" class="heading-permalink" aria-hidden="true" title="Permalink">#</a>What is an Index?</h3>
<pre><code data-theme="material-theme-palenight" data-lang="bash" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #00000080;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #FFCB6B;">movies</span></div><div class='line'><span style="color: #FFCB6B;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">Document</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">1</span></div><div class='line'><span style="color: #FFCB6B;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">Document</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">2</span></div><div class='line'><span style="color: #FFCB6B;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">Document</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">3</span></div><div class='line'><span style="color: #FFCB6B;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">...</span></div></code></pre>
<h3><a id="content-what-is-a-document" href="#content-what-is-a-document" class="heading-permalink" aria-hidden="true" title="Permalink">#</a>What is a Document?</h3>
<pre><code data-theme="material-theme-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #00000080;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #A6ACCD;">Document </span><span style="color: #89DDFF;">=</span><span style="color: #A6ACCD;"> JSON</span></div></code></pre>
<pre><code data-theme="material-theme-palenight" data-lang="json" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #00000080;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #89DDFF;">{</span></div><div class='line'><span style="color: #A6ACCD;">   </span><span style="color: #89DDFF;">&quot;</span><span style="color: #C792EA;">name</span><span style="color: #89DDFF;">&quot;</span><span style="color: #89DDFF;">:</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&quot;</span><span style="color: #C3E88D;">Mary Poppings</span><span style="color: #89DDFF;">&quot;</span></div><div class='line'><span style="color: #89DDFF;">}</span></div></code></pre>
<pre><code data-theme="material-theme-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #00000080;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #F78C6C;">new</span><span style="color: #A6ACCD;"> </span><span style="color: #FFCB6B;">Document</span><span style="color: #89DDFF;">([</span><span style="color: #89DDFF;">&#39;</span><span style="color: #C3E88D;">name</span><span style="color: #89DDFF;">&#39;</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">=&gt;</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#39;</span><span style="color: #C3E88D;">Mary Poppins</span><span style="color: #89DDFF;">&#39;</span><span style="color: #89DDFF;">]),</span></div></code></pre>
<h2><a id="content-first-index" href="#content-first-index" class="heading-permalink" aria-hidden="true" title="Permalink">#</a>First Index</h2>
<h3><a id="content-create-an-index" href="#content-create-an-index" class="heading-permalink" aria-hidden="true" title="Permalink">#</a>Create an Index</h3>
<pre><code data-theme="material-theme-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #00000080;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #89DDFF;">$</span><span style="color: #A6ACCD;">index </span><span style="color: #89DDFF;">=</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">$</span><span style="color: #A6ACCD;">sigmie</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">newIndex</span><span style="color: #89DDFF;">(</span><span style="color: #89DDFF;">&#39;</span><span style="color: #C3E88D;">movies</span><span style="color: #89DDFF;">&#39;</span><span style="color: #89DDFF;">)-&gt;</span><span style="color: #82AAFF;">create</span><span style="color: #89DDFF;">();</span></div></code></pre>
<pre><code data-theme="material-theme-palenight" data-lang="bash" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #00000080;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #FFCB6B;">movies</span></div><div class='line'><span style="color: #FFCB6B;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #676E95;"># empty</span></div></code></pre>
<h3><a id="content-add-documents" href="#content-add-documents" class="heading-permalink" aria-hidden="true" title="Permalink">#</a>Add Documents</h3>
<pre><code data-theme="material-theme-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #00000080;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #89DDFF;">$</span><span style="color: #A6ACCD;">documents </span><span style="color: #89DDFF;">=</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">[</span></div><div class='line'><span style="color: #A6ACCD;">    </span><span style="color: #F78C6C;">new</span><span style="color: #A6ACCD;"> </span><span style="color: #FFCB6B;">Document</span><span style="color: #89DDFF;">([</span><span style="color: #89DDFF;">&#39;</span><span style="color: #C3E88D;">name</span><span style="color: #89DDFF;">&#39;</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">=&gt;</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#39;</span><span style="color: #C3E88D;">Mary Poppins</span><span style="color: #89DDFF;">&#39;</span><span style="color: #89DDFF;">]),</span></div><div class='line'><span style="color: #A6ACCD;">    </span><span style="color: #F78C6C;">new</span><span style="color: #A6ACCD;"> </span><span style="color: #FFCB6B;">Document</span><span style="color: #89DDFF;">([</span><span style="color: #89DDFF;">&#39;</span><span style="color: #C3E88D;">name</span><span style="color: #89DDFF;">&#39;</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">=&gt;</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#39;</span><span style="color: #C3E88D;">The Mighty Ducks</span><span style="color: #89DDFF;">&#39;</span><span style="color: #89DDFF;">]),</span></div><div class='line'><span style="color: #A6ACCD;">    </span><span style="color: #F78C6C;">new</span><span style="color: #A6ACCD;"> </span><span style="color: #FFCB6B;">Document</span><span style="color: #89DDFF;">([</span><span style="color: #89DDFF;">&#39;</span><span style="color: #C3E88D;">name</span><span style="color: #89DDFF;">&#39;</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">=&gt;</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&#39;</span><span style="color: #C3E88D;">The Parent Trap</span><span style="color: #89DDFF;">&#39;</span><span style="color: #89DDFF;">]),</span></div><div class='line'><span style="color: #89DDFF;">];</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #89DDFF;">$</span><span style="color: #A6ACCD;">index</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">collect</span><span style="color: #89DDFF;">()-&gt;</span><span style="color: #82AAFF;">merge</span><span style="color: #89DDFF;">($</span><span style="color: #A6ACCD;">documents</span><span style="color: #89DDFF;">);</span></div></code></pre>
<pre><code data-theme="material-theme-palenight" data-lang="bash" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #00000080;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #FFCB6B;">movies</span></div><div class='line'><span style="color: #FFCB6B;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&quot;</span><span style="color: #C3E88D;">Mary Poppins</span><span style="color: #89DDFF;">&quot;</span></div><div class='line'><span style="color: #FFCB6B;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&quot;</span><span style="color: #C3E88D;">The Mighty Ducks</span><span style="color: #89DDFF;">&quot;</span></div><div class='line'><span style="color: #FFCB6B;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&quot;</span><span style="color: #C3E88D;">The Parent Trap</span><span style="color: #89DDFF;">&quot;</span></div></code></pre>
<h2><a id="content-analysis" href="#content-analysis" class="heading-permalink" aria-hidden="true" title="Permalink">#</a>Analysis</h2>
<h3><a id="content-what-is-analysis" href="#content-what-is-analysis" class="heading-permalink" aria-hidden="true" title="Permalink">#</a>What is Analysis?</h3>
<p>Without going into details the index analyzes the given text according
to the filters that your specify.</p>
<p>To understand how it’s done visit the analysis section. So if create an index like this</p>
<pre><code data-theme="material-theme-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #00000080;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #89DDFF;">$</span><span style="color: #A6ACCD;">sigmie</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">newIndex</span><span style="color: #89DDFF;">(</span><span style="color: #89DDFF;">&#39;</span><span style="color: #C3E88D;">disney</span><span style="color: #89DDFF;">&#39;</span><span style="color: #89DDFF;">)</span></div><div class='line'><span style="color: #A6ACCD;">    </span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">tokenizeOnWhitespaces</span><span style="color: #89DDFF;">()</span></div><div class='line'><span style="color: #A6ACCD;">    </span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">lowercase</span><span style="color: #89DDFF;">()</span></div><div class='line'><span style="color: #A6ACCD;">    </span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">create</span><span style="color: #89DDFF;">();</span></div></code></pre>
<p>the four movies for above are as follow the <code>name</code> is splited
on <code>whitespaces</code> into tokens and then the tokens are <code>lowercased</code>.</p>
<p>Resulting to the following.</p>
<h3><a id="content-how-are-documents-analyzed" href="#content-how-are-documents-analyzed" class="heading-permalink" aria-hidden="true" title="Permalink">#</a>How are Documents analyzed?</h3>
<pre><code data-theme="material-theme-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #00000080;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #89DDFF;">|</span><span style="color: #A6ACCD;"> Document </span><span style="color: #F78C6C;">1</span><span style="color: #A6ACCD;">   </span><span style="color: #89DDFF;">|</span><span style="color: #A6ACCD;"> Document </span><span style="color: #F78C6C;">2</span><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">|</span><span style="color: #A6ACCD;"> Document </span><span style="color: #F78C6C;">3</span><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">|</span></div><div class='line'><span style="color: #89DDFF;">|</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">-----------</span><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">|</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">-----------</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">|</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">------------|</span></div><div class='line'><span style="color: #89DDFF;">|</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&quot;</span><span style="color: #C3E88D;">mary</span><span style="color: #89DDFF;">&quot;</span><span style="color: #A6ACCD;">       </span><span style="color: #89DDFF;">|</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&quot;</span><span style="color: #C3E88D;">the</span><span style="color: #89DDFF;">&quot;</span><span style="color: #A6ACCD;">       </span><span style="color: #89DDFF;">|</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&quot;</span><span style="color: #C3E88D;">the</span><span style="color: #89DDFF;">&quot;</span><span style="color: #A6ACCD;">       </span><span style="color: #89DDFF;">|</span></div><div class='line'><span style="color: #89DDFF;">|</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&quot;</span><span style="color: #C3E88D;">poppings</span><span style="color: #89DDFF;">&quot;</span><span style="color: #A6ACCD;">   </span><span style="color: #89DDFF;">|</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&quot;</span><span style="color: #C3E88D;">mighty</span><span style="color: #89DDFF;">&quot;</span><span style="color: #A6ACCD;">    </span><span style="color: #89DDFF;">|</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&quot;</span><span style="color: #C3E88D;">parent</span><span style="color: #89DDFF;">&quot;</span><span style="color: #A6ACCD;">    </span><span style="color: #89DDFF;">|</span></div><div class='line'><span style="color: #89DDFF;">|</span><span style="color: #A6ACCD;">              </span><span style="color: #89DDFF;">|</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&quot;</span><span style="color: #C3E88D;">ducks</span><span style="color: #89DDFF;">&quot;</span><span style="color: #A6ACCD;">     </span><span style="color: #89DDFF;">|</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&quot;</span><span style="color: #C3E88D;">trap</span><span style="color: #89DDFF;">&quot;</span><span style="color: #A6ACCD;">      </span><span style="color: #89DDFF;">|</span></div></code></pre>
<p>So if we search for <code>Mary</code> the index returns the document
that containts query string.</p>
<p>The same filters are also applied to the query string and in this
case <code>Mary</code>  becomeds <code>mary</code>.</p>
<h3><a id="content-how-is-the-query-string-analyzed" href="#content-how-is-the-query-string-analyzed" class="heading-permalink" aria-hidden="true" title="Permalink">#</a>How is the Query string analyzed?</h3>
<pre><code data-theme="material-theme-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #00000080;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #89DDFF;">|</span><span style="color: #A6ACCD;"> Query        </span><span style="color: #89DDFF;">|</span><span style="color: #A6ACCD;"> Analyzed Query </span><span style="color: #89DDFF;">|</span></div><div class='line'><span style="color: #89DDFF;">|</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">-----------</span><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">|</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">--------------</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">|</span></div><div class='line'><span style="color: #89DDFF;">|</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&quot;</span><span style="color: #C3E88D;">Mary</span><span style="color: #89DDFF;">&quot;</span><span style="color: #A6ACCD;">       </span><span style="color: #89DDFF;">|</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&quot;</span><span style="color: #C3E88D;">mary</span><span style="color: #89DDFF;">&quot;</span><span style="color: #A6ACCD;">          </span><span style="color: #89DDFF;">|</span></div></code></pre>
<p>Now the search returns the Documents that contains this term.</p>
<pre><code data-theme="material-theme-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #00000080;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #89DDFF;">|</span><span style="color: #A6ACCD;"> Term         </span><span style="color: #89DDFF;">|</span><span style="color: #A6ACCD;"> Document </span><span style="color: #F78C6C;">1</span><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">|</span><span style="color: #A6ACCD;"> Document </span><span style="color: #F78C6C;">2</span><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">|</span><span style="color: #A6ACCD;"> Document </span><span style="color: #F78C6C;">3</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">|</span></div><div class='line'><span style="color: #89DDFF;">|</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">-----------</span><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">|</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">-----------</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">|</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">------------|------------|</span></div><div class='line'><span style="color: #89DDFF;">|</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&quot;</span><span style="color: #C3E88D;">mary</span><span style="color: #89DDFF;">&quot;</span><span style="color: #A6ACCD;">       </span><span style="color: #89DDFF;">|</span><span style="color: #A6ACCD;"> x           </span><span style="color: #89DDFF;">|</span><span style="color: #A6ACCD;">             </span><span style="color: #89DDFF;">|</span><span style="color: #A6ACCD;">            </span><span style="color: #89DDFF;">|</span></div></code></pre>
<pre><code data-theme="material-theme-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #00000080;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #89DDFF;">|</span><span style="color: #A6ACCD;"> Term         </span><span style="color: #89DDFF;">|</span><span style="color: #A6ACCD;"> Freq   </span><span style="color: #89DDFF;">|</span><span style="color: #A6ACCD;"> Occurrences </span><span style="color: #89DDFF;">|</span></div><div class='line'><span style="color: #89DDFF;">|</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">-----------</span><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">|</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">------</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">|</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">-----------</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">|</span></div><div class='line'><span style="color: #89DDFF;">|</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&quot;</span><span style="color: #C3E88D;">mary</span><span style="color: #89DDFF;">&quot;</span><span style="color: #A6ACCD;">       </span><span style="color: #89DDFF;">|</span><span style="color: #A6ACCD;"> </span><span style="color: #F78C6C;">1</span><span style="color: #A6ACCD;">      </span><span style="color: #89DDFF;">|</span><span style="color: #A6ACCD;"> Document </span><span style="color: #F78C6C;">1</span><span style="color: #A6ACCD;">  </span><span style="color: #89DDFF;">|</span></div></code></pre>
<p>You can find more information in the <strong>Analysis</strong> section about in detail
how this process works and all it’s available methods.</p>
<h3><a id="content-how-to-test-analysis" href="#content-how-to-test-analysis" class="heading-permalink" aria-hidden="true" title="Permalink">#</a>How to test Analysis?</h3>
<pre><code data-theme="material-theme-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #00000080;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #89DDFF;">$</span><span style="color: #A6ACCD;">tokens </span><span style="color: #89DDFF;">=</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">$</span><span style="color: #A6ACCD;">index</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">analyze</span><span style="color: #89DDFF;">(</span><span style="color: #89DDFF;">&#39;</span><span style="color: #C3E88D;">Mary Poppings</span><span style="color: #89DDFF;">&#39;</span><span style="color: #89DDFF;">);</span><span style="color: #A6ACCD;"> </span><span style="color: #676E95;">// [ &quot;mary&quot;, &quot;poppings&quot;]</span></div></code></pre>
<h3><a id="content-index-update" href="#content-index-update" class="heading-permalink" aria-hidden="true" title="Permalink">#</a>Index Update</h3>
<pre><code data-theme="material-theme-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #00000080;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #F78C6C;">use</span><span style="color: #FFCB6B;"> </span><span style="color: #A6ACCD;">Sigmie</span><span style="color: #89DDFF;">\</span><span style="color: #A6ACCD;">Index</span><span style="color: #89DDFF;">\</span><span style="color: #A6ACCD;">UpdateIndex</span><span style="color: #89DDFF;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #89DDFF;">$</span><span style="color: #A6ACCD;">sigmie</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">index</span><span style="color: #89DDFF;">(</span><span style="color: #89DDFF;">&#39;</span><span style="color: #C3E88D;">movies</span><span style="color: #89DDFF;">&#39;</span><span style="color: #89DDFF;">)-&gt;</span><span style="color: #82AAFF;">update</span><span style="color: #89DDFF;">(</span><span style="color: #C792EA;">function</span><span style="color: #89DDFF;">(</span><span style="color: #FFCB6B;">UpdateIndex</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">$</span><span style="color: #A6ACCD;">updateIndex</span><span style="color: #89DDFF;">){</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #89DDFF;">    </span><span style="color: #676E95;">// update</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #89DDFF;">});</span></div></code></pre>
<div class="callout danger">
You need to add all the analysis methods since they are not merged.
</div>
<h2><a id="content-delete-an-index" href="#content-delete-an-index" class="heading-permalink" aria-hidden="true" title="Permalink">#</a>Delete an Index</h2>
<pre><code data-theme="material-theme-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #00000080;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #89DDFF;">$</span><span style="color: #A6ACCD;">sigmie</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">index</span><span style="color: #89DDFF;">(</span><span style="color: #89DDFF;">&#39;</span><span style="color: #C3E88D;">movies</span><span style="color: #89DDFF;">&#39;</span><span style="color: #89DDFF;">)-&gt;</span><span style="color: #82AAFF;">delete</span><span style="color: #89DDFF;">();</span></div></code></pre>
<h2><a id="content-settings" href="#content-settings" class="heading-permalink" aria-hidden="true" title="Permalink">#</a>Settings</h2>
<pre><code data-theme="material-theme-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #00000080;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #89DDFF;">$</span><span style="color: #A6ACCD;">newIndex</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">config</span><span style="color: #89DDFF;">(</span><span style="color: #89DDFF;">&#39;</span><span style="color: #C3E88D;">index.max_ngram_diff</span><span style="color: #89DDFF;">&#39;</span><span style="color: #89DDFF;">,</span><span style="color: #A6ACCD;"> </span><span style="color: #F78C6C;">3</span><span style="color: #89DDFF;">);</span></div></code></pre>
<p>You can find the available index settings for Elasticsearch <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/index-modules.html">here</a>.</p>
<h2><a id="content-how-update-works" href="#content-how-update-works" class="heading-permalink" aria-hidden="true" title="Permalink">#</a>How update works</h2>
<h3><a id="content-phase-1---create-new-index" href="#content-phase-1---create-new-index" class="heading-permalink" aria-hidden="true" title="Permalink">#</a>Phase 1 - Create new index</h3>
<pre><code data-theme="material-theme-palenight" data-lang="bash" class='torchlight has-add-lines has-diff-lines' style='background-color: #292D3E; --theme-selection-background: #00000080;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number"> </span><span style="color: #FFCB6B;">movies</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">(</span><span style="color: #FFCB6B;">movies_20221122210823379774</span><span style="color: #89DDFF;">)</span></div><div class='line'><span style="color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number"> </span><span style="color: #FFCB6B;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&quot;</span><span style="color: #C3E88D;">Mary Poppins</span><span style="color: #89DDFF;">&quot;</span></div><div class='line'><span style="color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number"> </span><span style="color: #FFCB6B;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&quot;</span><span style="color: #C3E88D;">The Mighty Ducks</span><span style="color: #89DDFF;">&quot;</span></div><div class='line'><span style="color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number"> </span><span style="color: #FFCB6B;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&quot;</span><span style="color: #C3E88D;">The Parent Trap</span><span style="color: #89DDFF;">&quot;</span></div><div class='line'><span style="color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number"> </span>&nbsp;</div><div class='line line-add line-has-background' style='background-color: #89DDFF20'><span style="color:#C3E88D; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number">+</span><span style="color: #C3E88D;">movies_20221222210823379774</span><span style="color: #C3E88D;"> </span></div><div class='line'><span style="color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number"> </span><span style="color: #FFCB6B;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #676E95;"># empty</span></div></code></pre>
<h3><a id="content-phase-2---reindex-documents" href="#content-phase-2---reindex-documents" class="heading-permalink" aria-hidden="true" title="Permalink">#</a>Phase 2 - Reindex documents</h3>
<pre><code data-theme="material-theme-palenight" data-lang="bash" class='torchlight has-add-lines has-diff-lines' style='background-color: #292D3E; --theme-selection-background: #00000080;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number"> </span><span style="color: #FFCB6B;">movies</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">(</span><span style="color: #FFCB6B;">movies_20221122210823379774</span><span style="color: #89DDFF;">)</span></div><div class='line'><span style="color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number"> </span><span style="color: #FFCB6B;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&quot;</span><span style="color: #C3E88D;">Mary Poppins</span><span style="color: #89DDFF;">&quot;</span></div><div class='line'><span style="color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number"> </span><span style="color: #FFCB6B;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&quot;</span><span style="color: #C3E88D;">The Mighty Ducks</span><span style="color: #89DDFF;">&quot;</span></div><div class='line'><span style="color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number"> </span><span style="color: #FFCB6B;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&quot;</span><span style="color: #C3E88D;">The Parent Trap</span><span style="color: #89DDFF;">&quot;</span></div><div class='line'><span style="color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number"> </span>&nbsp;</div><div class='line'><span style="color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number"> </span><span style="color: #FFCB6B;">movies_20221222210823379774</span></div><div class='line line-add line-has-background' style='background-color: #89DDFF20'><span style="color:#C3E88D; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number">+</span><span style="color: #C3E88D;">├─</span><span style="color: #C3E88D;"> </span><span style="color: #C3E88D;">&quot;</span><span style="color: #C3E88D;">Mary Poppins</span><span style="color: #C3E88D;">&quot;</span><span style="color: #C3E88D;"> </span></div><div class='line line-add line-has-background' style='background-color: #89DDFF20'><span style="color:#C3E88D; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number">+</span><span style="color: #C3E88D;">├─</span><span style="color: #C3E88D;"> </span><span style="color: #C3E88D;">&quot;</span><span style="color: #C3E88D;">The Mighty Ducks</span><span style="color: #C3E88D;">&quot;</span><span style="color: #C3E88D;"> </span></div><div class='line line-add line-has-background' style='background-color: #89DDFF20'><span style="color:#C3E88D; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number">+</span><span style="color: #C3E88D;">├─</span><span style="color: #C3E88D;"> </span><span style="color: #C3E88D;">&quot;</span><span style="color: #C3E88D;">The Parent Trap</span><span style="color: #C3E88D;">&quot;</span><span style="color: #C3E88D;"> </span></div></code></pre>
<h3><a id="content-phase-3---swap-alias" href="#content-phase-3---swap-alias" class="heading-permalink" aria-hidden="true" title="Permalink">#</a>Phase 3 - Swap Alias</h3>
<pre><code data-theme="material-theme-palenight" data-lang="bash" class='torchlight has-add-lines has-diff-lines' style='background-color: #292D3E; --theme-selection-background: #00000080;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number"> </span><span style="color: #FFCB6B;">movies_20221122210823379774</span></div><div class='line'><span style="color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number"> </span><span style="color: #FFCB6B;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&quot;</span><span style="color: #C3E88D;">Mary Poppins</span><span style="color: #89DDFF;">&quot;</span></div><div class='line'><span style="color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number"> </span><span style="color: #FFCB6B;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&quot;</span><span style="color: #C3E88D;">The Mighty Ducks</span><span style="color: #89DDFF;">&quot;</span></div><div class='line'><span style="color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number"> </span><span style="color: #FFCB6B;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&quot;</span><span style="color: #C3E88D;">The Parent Trap</span><span style="color: #89DDFF;">&quot;</span></div><div class='line'><span style="color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number"> </span>&nbsp;</div><div class='line line-add line-has-background' style='background-color: #89DDFF20'><span style="color:#C3E88D; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number">+</span><span style="color: #C3E88D;">movies</span><span style="color: #C3E88D;"> </span><span style="color: #C3E88D;">(</span><span style="color: #C3E88D;">movies_20221222210823379774</span><span style="color: #C3E88D;">)</span><span style="color: #C3E88D;"> </span></div><div class='line'><span style="color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number"> </span><span style="color: #FFCB6B;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&quot;</span><span style="color: #C3E88D;">Mary Poppins</span><span style="color: #89DDFF;">&quot;</span></div><div class='line'><span style="color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number"> </span><span style="color: #FFCB6B;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&quot;</span><span style="color: #C3E88D;">The Mighty Ducks</span><span style="color: #89DDFF;">&quot;</span></div><div class='line'><span style="color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number"> </span><span style="color: #FFCB6B;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&quot;</span><span style="color: #C3E88D;">The Parent Trap</span><span style="color: #89DDFF;">&quot;</span></div></code></pre>
<h3><a id="content-phase-4---delete-old-index" href="#content-phase-4---delete-old-index" class="heading-permalink" aria-hidden="true" title="Permalink">#</a>Phase 4 - Delete old index</h3>
<pre><code data-theme="material-theme-palenight" data-lang="bash" class='torchlight has-add-lines has-remove-lines has-diff-lines' style='background-color: #292D3E; --theme-selection-background: #00000080;'><!-- Syntax highlighted by torchlight.dev --><div class='line line-remove line-has-background' style='background-color: #ff9cac20'><span style="color:#f07178; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number">-</span><span style="color: #f07178;">movies_20221122210823379774</span><span style="color: #f07178;"> </span></div><div class='line line-remove line-has-background' style='background-color: #ff9cac20'><span style="color:#f07178; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number">-</span><span style="color: #f07178;">├─</span><span style="color: #f07178;"> </span><span style="color: #f07178;">&quot;</span><span style="color: #f07178;">Mary Poppins</span><span style="color: #f07178;">&quot;</span><span style="color: #f07178;"> </span></div><div class='line line-remove line-has-background' style='background-color: #ff9cac20'><span style="color:#f07178; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number">-</span><span style="color: #f07178;">├─</span><span style="color: #f07178;"> </span><span style="color: #f07178;">&quot;</span><span style="color: #f07178;">The Mighty Ducks</span><span style="color: #f07178;">&quot;</span><span style="color: #f07178;"> </span></div><div class='line line-remove line-has-background' style='background-color: #ff9cac20'><span style="color:#f07178; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number">-</span><span style="color: #f07178;">├─</span><span style="color: #f07178;"> </span><span style="color: #f07178;">&quot;</span><span style="color: #f07178;">The Parent Trap</span><span style="color: #f07178;">&quot;</span><span style="color: #f07178;"> </span></div><div class='line'><span style="color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number"> </span>&nbsp;</div><div class='line line-add line-has-background' style='background-color: #89DDFF20'><span style="color:#C3E88D; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number">+</span><span style="color: #C3E88D;">movies</span><span style="color: #C3E88D;"> </span><span style="color: #C3E88D;">(</span><span style="color: #C3E88D;">movies_20221222210823379774</span><span style="color: #C3E88D;">)</span><span style="color: #C3E88D;"> </span></div><div class='line'><span style="color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number"> </span><span style="color: #FFCB6B;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&quot;</span><span style="color: #C3E88D;">Mary Poppins</span><span style="color: #89DDFF;">&quot;</span></div><div class='line'><span style="color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number"> </span><span style="color: #FFCB6B;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&quot;</span><span style="color: #C3E88D;">The Mighty Ducks</span><span style="color: #89DDFF;">&quot;</span></div><div class='line'><span style="color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number"> </span><span style="color: #FFCB6B;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #89DDFF;">&quot;</span><span style="color: #C3E88D;">The Parent Trap</span><span style="color: #89DDFF;">&quot;</span></div></code></pre>
<h2><a id="content-shards" href="#content-shards" class="heading-permalink" aria-hidden="true" title="Permalink">#</a>Shards</h2>
<h3><a id="content-defining-shards" href="#content-defining-shards" class="heading-permalink" aria-hidden="true" title="Permalink">#</a>Defining shards</h3>
<pre><code data-theme="material-theme-palenight" data-lang="php" class='torchlight has-highlight-lines' style='background-color: #292D3E; --theme-selection-background: #00000080;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #89DDFF;">$</span><span style="color: #A6ACCD;">sigmie</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">newIndex</span><span style="color: #89DDFF;">(</span><span style="color: #89DDFF;">&#39;</span><span style="color: #C3E88D;">disney</span><span style="color: #89DDFF;">&#39;</span><span style="color: #89DDFF;">)</span></div><div class='line line-highlight line-has-background' style='background-color: #00000050'><span style="color: #A6ACCD;">    </span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">shards</span><span style="color: #89DDFF;">(</span><span style="color: #F78C6C;">1</span><span style="color: #89DDFF;">)</span><span style="color: #A6ACCD;"> </span></div><div class='line line-highlight line-has-background' style='background-color: #00000050'><span style="color: #A6ACCD;">    </span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">replicas</span><span style="color: #89DDFF;">(</span><span style="color: #F78C6C;">2</span><span style="color: #89DDFF;">)</span><span style="color: #A6ACCD;"> </span></div><div class='line'><span style="color: #A6ACCD;">    </span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">create</span><span style="color: #89DDFF;">();</span></div></code></pre>
<h3><a id="content-what-is-a-shard" href="#content-what-is-a-shard" class="heading-permalink" aria-hidden="true" title="Permalink">#</a>What is a shard?</h3>
<pre><code data-theme="material-theme-palenight" data-lang="bash" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #00000080;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #FFCB6B;">movies</span></div><div class='line'><span style="color: #FFCB6B;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">shard</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">1</span></div><div class='line'><span style="color: #FFCB6B;">│</span><span style="color: #A6ACCD;">  </span><span style="color: #C3E88D;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">document</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">1</span></div><div class='line'><span style="color: #FFCB6B;">│</span><span style="color: #A6ACCD;">  </span><span style="color: #C3E88D;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">document</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">2</span></div><div class='line'><span style="color: #FFCB6B;">│</span><span style="color: #A6ACCD;">  </span><span style="color: #C3E88D;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">document</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">3</span></div><div class='line'><span style="color: #FFCB6B;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">shard</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">2</span></div><div class='line'><span style="color: #FFCB6B;">│</span><span style="color: #A6ACCD;">  </span><span style="color: #C3E88D;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">document</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">4</span></div><div class='line'><span style="color: #FFCB6B;">│</span><span style="color: #A6ACCD;">  </span><span style="color: #C3E88D;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">document</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">5</span></div><div class='line'><span style="color: #FFCB6B;">│</span><span style="color: #A6ACCD;">  </span><span style="color: #C3E88D;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">document</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">6</span></div><div class='line'><span style="color: #FFCB6B;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">shard</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">3</span></div><div class='line'><span style="color: #FFCB6B;">│</span><span style="color: #A6ACCD;">  </span><span style="color: #C3E88D;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">document</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">7</span></div><div class='line'><span style="color: #FFCB6B;">│</span><span style="color: #A6ACCD;">  </span><span style="color: #C3E88D;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">document</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">8</span></div></code></pre>
<h3><a id="content-thumb-rules" href="#content-thumb-rules" class="heading-permalink" aria-hidden="true" title="Permalink">#</a>Thumb rules</h3>
<ul>
<li>25-30 GB</li>
</ul>
<h3><a id="content-shards-behavior" href="#content-shards-behavior" class="heading-permalink" aria-hidden="true" title="Permalink">#</a>Shards behavior</h3>
<pre><code data-theme="material-theme-palenight" data-lang="bash" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #00000080;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #FFCB6B;">cluster</span></div><div class='line'><span style="color: #FFCB6B;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">server</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">1</span></div><div class='line'><span style="color: #FFCB6B;">│</span><span style="color: #A6ACCD;">  </span><span style="color: #C3E88D;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">primary</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">1</span></div><div class='line'><span style="color: #FFCB6B;">│</span><span style="color: #A6ACCD;">  </span><span style="color: #C3E88D;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">replica</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">of</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">primary</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">2</span></div><div class='line'><span style="color: #FFCB6B;">│</span><span style="color: #A6ACCD;">  </span><span style="color: #C3E88D;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">replica</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">of</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">primary</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">3</span></div><div class='line'><span style="color: #FFCB6B;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">server</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">2</span></div><div class='line'><span style="color: #FFCB6B;">│</span><span style="color: #A6ACCD;">  </span><span style="color: #C3E88D;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">primary</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">2</span></div><div class='line'><span style="color: #FFCB6B;">│</span><span style="color: #A6ACCD;">  </span><span style="color: #C3E88D;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">replica</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">of</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">primary</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">1</span></div><div class='line'><span style="color: #FFCB6B;">│</span><span style="color: #A6ACCD;">  </span><span style="color: #C3E88D;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">replica</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">of</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">primary</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">3</span></div><div class='line'><span style="color: #FFCB6B;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">server</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">3</span></div><div class='line'><span style="color: #FFCB6B;">│</span><span style="color: #A6ACCD;">  </span><span style="color: #C3E88D;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">primary</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">3</span></div><div class='line'><span style="color: #FFCB6B;">│</span><span style="color: #A6ACCD;">  </span><span style="color: #C3E88D;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">replica</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">of</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">primary</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">2</span></div><div class='line'><span style="color: #FFCB6B;">│</span><span style="color: #A6ACCD;">  </span><span style="color: #C3E88D;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">replica</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">of</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">primary</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">1</span></div></code></pre>
<h4><a id="content-what-happens-if-a-node-dies" href="#content-what-happens-if-a-node-dies" class="heading-permalink" aria-hidden="true" title="Permalink">#</a>What happens if a node dies?</h4>
<pre><code data-theme="material-theme-palenight" data-lang="sh" class='torchlight has-add-lines has-remove-lines has-diff-lines' style='background-color: #292D3E; --theme-selection-background: #00000080;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number"> </span><span style="color: #FFCB6B;">cluster</span></div><div class='line'><span style="color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number"> </span><span style="color: #FFCB6B;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">server</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">1</span></div><div class='line'><span style="color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number"> </span><span style="color: #FFCB6B;">│</span><span style="color: #A6ACCD;">  </span><span style="color: #C3E88D;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">primary</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">1</span></div><div class='line line-add line-has-background' style='background-color: #89DDFF20'><span style="color:#C3E88D; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number">+</span><span style="color: #C3E88D;">│</span><span style="color: #C3E88D;">  </span><span style="color: #C3E88D;">├─</span><span style="color: #C3E88D;"> </span><span style="color: #C3E88D;">primary</span><span style="color: #C3E88D;"> </span><span style="color: #C3E88D;">3</span><span style="color: #C3E88D;"> </span></div><div class='line line-add line-has-background' style='background-color: #89DDFF20'><span style="color:#C3E88D; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number">+</span><span style="color: #C3E88D;">│</span><span style="color: #C3E88D;">  </span><span style="color: #C3E88D;">├─</span><span style="color: #C3E88D;"> </span><span style="color: #C3E88D;">replica</span><span style="color: #C3E88D;"> </span><span style="color: #C3E88D;">of</span><span style="color: #C3E88D;"> </span><span style="color: #C3E88D;">primary</span><span style="color: #C3E88D;"> </span><span style="color: #C3E88D;">2</span><span style="color: #C3E88D;"> </span></div><div class='line'><span style="color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number"> </span><span style="color: #FFCB6B;">│</span><span style="color: #A6ACCD;">  </span><span style="color: #C3E88D;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">replica</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">of</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">primary</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">2</span></div><div class='line'><span style="color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number"> </span><span style="color: #FFCB6B;">│</span><span style="color: #A6ACCD;">  </span><span style="color: #C3E88D;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">replica</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">of</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">primary</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">3</span></div><div class='line'><span style="color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number"> </span><span style="color: #FFCB6B;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">server</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">2</span></div><div class='line'><span style="color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number"> </span><span style="color: #FFCB6B;">│</span><span style="color: #A6ACCD;">  </span><span style="color: #C3E88D;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">primary</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">2</span></div><div class='line'><span style="color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number"> </span><span style="color: #FFCB6B;">│</span><span style="color: #A6ACCD;">  </span><span style="color: #C3E88D;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">replica</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">of</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">primary</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">1</span></div><div class='line line-add line-has-background' style='background-color: #89DDFF20'><span style="color:#C3E88D; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number">+</span><span style="color: #C3E88D;">│</span><span style="color: #C3E88D;">  </span><span style="color: #C3E88D;">├─</span><span style="color: #C3E88D;"> </span><span style="color: #C3E88D;">replica</span><span style="color: #C3E88D;"> </span><span style="color: #C3E88D;">of</span><span style="color: #C3E88D;"> </span><span style="color: #C3E88D;">primary</span><span style="color: #C3E88D;"> </span><span style="color: #C3E88D;">1</span><span style="color: #C3E88D;"> </span></div><div class='line'><span style="color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number"> </span><span style="color: #FFCB6B;">│</span><span style="color: #A6ACCD;">  </span><span style="color: #C3E88D;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">replica</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">of</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">primary</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">3</span></div><div class='line line-remove line-has-background' style='background-color: #ff9cac20'><span style="color:#f07178; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number">-</span><span style="color: #f07178;">├─</span><span style="color: #f07178;"> </span><span style="color: #f07178;">server</span><span style="color: #f07178;"> </span><span style="color: #f07178;">3</span><span style="color: #f07178;"> </span></div><div class='line line-remove line-has-background' style='background-color: #ff9cac20'><span style="color:#f07178; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number">-</span><span style="color: #f07178;">│</span><span style="color: #f07178;">  </span><span style="color: #f07178;">├─</span><span style="color: #f07178;"> </span><span style="color: #f07178;">primary</span><span style="color: #f07178;"> </span><span style="color: #f07178;">3</span><span style="color: #f07178;"> </span></div><div class='line line-remove line-has-background' style='background-color: #ff9cac20'><span style="color:#f07178; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number">-</span><span style="color: #f07178;">│</span><span style="color: #f07178;">  </span><span style="color: #f07178;">├─</span><span style="color: #f07178;"> </span><span style="color: #f07178;">replica</span><span style="color: #f07178;"> </span><span style="color: #f07178;">of</span><span style="color: #f07178;"> </span><span style="color: #f07178;">primary</span><span style="color: #f07178;"> </span><span style="color: #f07178;">2</span><span style="color: #f07178;"> </span></div><div class='line line-remove line-has-background' style='background-color: #ff9cac20'><span style="color:#f07178; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number">-</span><span style="color: #f07178;">│</span><span style="color: #f07178;">  </span><span style="color: #f07178;">├─</span><span style="color: #f07178;"> </span><span style="color: #f07178;">replica</span><span style="color: #f07178;"> </span><span style="color: #f07178;">of</span><span style="color: #f07178;"> </span><span style="color: #f07178;">primary</span><span style="color: #f07178;"> </span><span style="color: #f07178;">1</span><span style="color: #f07178;"> </span></div></code></pre>
<h4><a id="content-what-happens-if-two-nodes-die" href="#content-what-happens-if-two-nodes-die" class="heading-permalink" aria-hidden="true" title="Permalink">#</a>What happens if two nodes die?</h4>
<pre><code data-theme="material-theme-palenight" data-lang="sh" class='torchlight has-add-lines has-remove-lines has-diff-lines' style='background-color: #292D3E; --theme-selection-background: #00000080;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number"> </span><span style="color: #FFCB6B;">cluster</span></div><div class='line'><span style="color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number"> </span><span style="color: #FFCB6B;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">server</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">1</span></div><div class='line'><span style="color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number"> </span><span style="color: #FFCB6B;">│</span><span style="color: #A6ACCD;">  </span><span style="color: #C3E88D;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">primary</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">1</span></div><div class='line line-add line-has-background' style='background-color: #89DDFF20'><span style="color:#C3E88D; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number">+</span><span style="color: #C3E88D;">│</span><span style="color: #C3E88D;">  </span><span style="color: #C3E88D;">├─</span><span style="color: #C3E88D;"> </span><span style="color: #C3E88D;">primary</span><span style="color: #C3E88D;"> </span><span style="color: #C3E88D;">3</span><span style="color: #C3E88D;"> </span></div><div class='line line-add line-has-background' style='background-color: #89DDFF20'><span style="color:#C3E88D; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number">+</span><span style="color: #C3E88D;">│</span><span style="color: #C3E88D;">  </span><span style="color: #C3E88D;">├─</span><span style="color: #C3E88D;"> </span><span style="color: #C3E88D;">replica</span><span style="color: #C3E88D;"> </span><span style="color: #C3E88D;">of</span><span style="color: #C3E88D;"> </span><span style="color: #C3E88D;">primary</span><span style="color: #C3E88D;"> </span><span style="color: #C3E88D;">2</span><span style="color: #C3E88D;"> </span></div><div class='line'><span style="color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number"> </span><span style="color: #FFCB6B;">│</span><span style="color: #A6ACCD;">  </span><span style="color: #C3E88D;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">replica</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">of</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">primary</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">2</span></div><div class='line'><span style="color:#3A3F58; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number"> </span><span style="color: #FFCB6B;">│</span><span style="color: #A6ACCD;">  </span><span style="color: #C3E88D;">├─</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">replica</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">of</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">primary</span><span style="color: #A6ACCD;"> </span><span style="color: #C3E88D;">3</span></div><div class='line line-add line-has-background' style='background-color: #89DDFF20'><span style="color:#C3E88D; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number">+</span><span style="color: #C3E88D;">│</span><span style="color: #C3E88D;">  </span><span style="color: #C3E88D;">├─</span><span style="color: #C3E88D;"> </span><span style="color: #C3E88D;">primary</span><span style="color: #C3E88D;"> </span><span style="color: #C3E88D;">2</span><span style="color: #C3E88D;"> </span></div><div class='line line-add line-has-background' style='background-color: #89DDFF20'><span style="color:#C3E88D; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number">+</span><span style="color: #C3E88D;">│</span><span style="color: #C3E88D;">  </span><span style="color: #C3E88D;">├─</span><span style="color: #C3E88D;"> </span><span style="color: #C3E88D;">replica</span><span style="color: #C3E88D;"> </span><span style="color: #C3E88D;">of</span><span style="color: #C3E88D;"> </span><span style="color: #C3E88D;">primary</span><span style="color: #C3E88D;"> </span><span style="color: #C3E88D;">1</span><span style="color: #C3E88D;"> </span></div><div class='line line-add line-has-background' style='background-color: #89DDFF20'><span style="color:#C3E88D; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number">+</span><span style="color: #C3E88D;">│</span><span style="color: #C3E88D;">  </span><span style="color: #C3E88D;">├─</span><span style="color: #C3E88D;"> </span><span style="color: #C3E88D;">replica</span><span style="color: #C3E88D;"> </span><span style="color: #C3E88D;">of</span><span style="color: #C3E88D;"> </span><span style="color: #C3E88D;">primary</span><span style="color: #C3E88D;"> </span><span style="color: #C3E88D;">1</span><span style="color: #C3E88D;"> </span></div><div class='line line-add line-has-background' style='background-color: #89DDFF20'><span style="color:#C3E88D; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number">+</span><span style="color: #C3E88D;">│</span><span style="color: #C3E88D;">  </span><span style="color: #C3E88D;">├─</span><span style="color: #C3E88D;"> </span><span style="color: #C3E88D;">replica</span><span style="color: #C3E88D;"> </span><span style="color: #C3E88D;">of</span><span style="color: #C3E88D;"> </span><span style="color: #C3E88D;">primary</span><span style="color: #C3E88D;"> </span><span style="color: #C3E88D;">3</span><span style="color: #C3E88D;"> </span></div><div class='line line-remove line-has-background' style='background-color: #ff9cac20'><span style="color:#f07178; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number">-</span><span style="color: #f07178;">├─</span><span style="color: #f07178;"> </span><span style="color: #f07178;">server</span><span style="color: #f07178;"> </span><span style="color: #f07178;">2</span><span style="color: #f07178;"> </span></div><div class='line line-remove line-has-background' style='background-color: #ff9cac20'><span style="color:#f07178; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number">-</span><span style="color: #f07178;">│</span><span style="color: #f07178;">  </span><span style="color: #f07178;">├─</span><span style="color: #f07178;"> </span><span style="color: #f07178;">primary</span><span style="color: #f07178;"> </span><span style="color: #f07178;">2</span><span style="color: #f07178;"> </span></div><div class='line line-remove line-has-background' style='background-color: #ff9cac20'><span style="color:#f07178; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number">-</span><span style="color: #f07178;">│</span><span style="color: #f07178;">  </span><span style="color: #f07178;">├─</span><span style="color: #f07178;"> </span><span style="color: #f07178;">replica</span><span style="color: #f07178;"> </span><span style="color: #f07178;">of</span><span style="color: #f07178;"> </span><span style="color: #f07178;">primary</span><span style="color: #f07178;"> </span><span style="color: #f07178;">1</span><span style="color: #f07178;"> </span></div><div class='line line-remove line-has-background' style='background-color: #ff9cac20'><span style="color:#f07178; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number">-</span><span style="color: #f07178;">│</span><span style="color: #f07178;">  </span><span style="color: #f07178;">├─</span><span style="color: #f07178;"> </span><span style="color: #f07178;">replica</span><span style="color: #f07178;"> </span><span style="color: #f07178;">of</span><span style="color: #f07178;"> </span><span style="color: #f07178;">primary</span><span style="color: #f07178;"> </span><span style="color: #f07178;">1</span><span style="color: #f07178;"> </span></div><div class='line line-remove line-has-background' style='background-color: #ff9cac20'><span style="color:#f07178; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number">-</span><span style="color: #f07178;">│</span><span style="color: #f07178;">  </span><span style="color: #f07178;">├─</span><span style="color: #f07178;"> </span><span style="color: #f07178;">replica</span><span style="color: #f07178;"> </span><span style="color: #f07178;">of</span><span style="color: #f07178;"> </span><span style="color: #f07178;">primary</span><span style="color: #f07178;"> </span><span style="color: #f07178;">3</span><span style="color: #f07178;"> </span></div><div class='line line-remove line-has-background' style='background-color: #ff9cac20'><span style="color:#f07178; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number">-</span><span style="color: #f07178;">├─</span><span style="color: #f07178;"> </span><span style="color: #f07178;">server</span><span style="color: #f07178;"> </span><span style="color: #f07178;">3</span><span style="color: #f07178;"> </span></div><div class='line line-remove line-has-background' style='background-color: #ff9cac20'><span style="color:#f07178; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number">-</span><span style="color: #f07178;">│</span><span style="color: #f07178;">  </span><span style="color: #f07178;">├─</span><span style="color: #f07178;"> </span><span style="color: #f07178;">primary</span><span style="color: #f07178;"> </span><span style="color: #f07178;">3</span><span style="color: #f07178;"> </span></div><div class='line line-remove line-has-background' style='background-color: #ff9cac20'><span style="color:#f07178; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number">-</span><span style="color: #f07178;">│</span><span style="color: #f07178;">  </span><span style="color: #f07178;">├─</span><span style="color: #f07178;"> </span><span style="color: #f07178;">replica</span><span style="color: #f07178;"> </span><span style="color: #f07178;">of</span><span style="color: #f07178;"> </span><span style="color: #f07178;">primary</span><span style="color: #f07178;"> </span><span style="color: #f07178;">2</span><span style="color: #f07178;"> </span></div><div class='line line-remove line-has-background' style='background-color: #ff9cac20'><span style="color:#f07178; text-align: right; -webkit-user-select: none; user-select: none;" class="line-number">-</span><span style="color: #f07178;">│</span><span style="color: #f07178;">  </span><span style="color: #f07178;">├─</span><span style="color: #f07178;"> </span><span style="color: #f07178;">replica</span><span style="color: #f07178;"> </span><span style="color: #f07178;">of</span><span style="color: #f07178;"> </span><span style="color: #f07178;">primary</span><span style="color: #f07178;"> </span><span style="color: #f07178;">1</span><span style="color: #f07178;"> </span></div></code></pre>
